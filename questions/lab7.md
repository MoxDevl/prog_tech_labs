# **Lab7**

## Вопросы

1. ### *Что такое ORM (Object-Relational Mapping), и как она используется при работе с базами данных? Какие преимущества и недостатки есть у данной технологии?*

    ORM это метод, позволяющий переносить данные из реляционных баз 
    данных в объекты из языка программирования.

    Преимущества в том, что не нужно писать много лишних запросов к БД.

    Недостатки:
    - ORM надстройка может слегка медленнее выполнять
    запросы к БД
    - нужно думать, как формировать запросы для БД, что является протечкой абстракции

2. ### *Что такое Object-Relational Impedance Mismatch?*

    Это набор из разных проблем переноса понятий из реляционных БД в 
    понятия ЯП.

3. ### *Какие виды состояний могут быть у сущности в используемой вами реализации ORM?*

    Можно посмотреть состояние используя `inspect()`, который возвращает
    `InstanceState`, у которого есть:
    
    - `.transient` — сущность, которая ещё не в БД
    
    - `.pending` — добавлена в index для следующего flushs
    
    - `.persistent` — сущность присутствующая в Session и имеющая запись в БД
    
    - `.deleted` — в момент пока происходит flush сущность находится в этом состоянии,
    после завершения перейдет в detached

    - `.detached` — сущность, которая соответствует/соответствовала какой-то сущности из БД,
    но сейчас не находится в какой-либо сессии
    
    _Пример использования:_ 
    ```
    from sqlalchemy import inspect
    insp = inspect(my_object)
    insp.persistent
    >>> True
    ```

4. ### *Как происходит работа со связями в ORM? Что такое ленивая загрузка связей?*



5. ### *Что такое “проблема N+1 запросов” (N+1 SELECT problem)? Из-за чего она возникает и какие есть способы ее решения?*

    Это проблема возникает из-за колекций принадлежащих некоторым объектам.

    #### *Объясню на примере с объектами `Car` и их коллекциями из `Wheel`*:

    При запросе всех `Car` нам ещё нужно будет заполнить их коллекции из `Wheel`.
    Наивным способ это делается по одному запросу для каждого объекта `Car`.
    
    Суммарное количество запросов к БД будет тогда составлять N+1, где N - количество машин.


    #### Способы решения — составлять по другому запросы

6. ### *Что такое CRUD сервис?*

    _Create, Read, Update, Delete_

    **CRUD** сервис — это сервис, который выполняет операции из аббревиатуры на хранилище данных.
    Обычно таковыми являются сервисы работающие с базами данных.
